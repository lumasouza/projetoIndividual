<!DOCTYPE html>
<html lang="pt-br">

<head>
    <link rel="stylesheet" href="telaCha.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>pesquisa | cházim?</title>
</head>

<body>
    <div class="header">
        <div class="nav">

            <img id="imgLogo" src="assets/logoChazim2.png" src="">

            <ul class="navbar">
                <li><a href="#">Home</a></li>
                <li><a class="login" href="./telaLogin.html">Login</a></li>
                <li><a class="cad" href="./telaCadastro.html">Cadastre-se</a></li>
            </ul>

        </div>
    </div>

    <div class="container">

        <div class="conteudo">

            <div class="pesquisa">
                <div class="subtitulo" style="text-align: center;">Pesquisar chá</div>
                <div id="divPesquisaCha"><input type="text" id="iptPesquisaCha" onblur="pesquisarCha()"></div>
                <div id="divMsgErroPesquisa"></div>
            </div>

            <!-- <div class="">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Quos impedit unde aperiam quas reprehenderit? Assumenda soluta atque culpa obcaecati exercitationem iure accusamus, voluptatum magni unde perferendis iste inventore tempore est?</div> -->



        </div>

    </div>

    <div class="container">

        <div class="conteudo">

            <div id="divNomeCha" class="titulo">Título</div>
            <div id="divNomePop" class="subtitulo">subtitulo</div>

            <div id="divDescCha" class="texto">
            </div>


            <div class="subtitulo2">Uso popular</div>
            <div class="topicos">
                <div class="fin">AAAAAA</div>
                <div class="fin">BBBBBBBBB</div>
                <div class="fin">CCCCCCCCCCCC</div>
            </div>

            <div class="subtitulo2">Contra-indicações</div>
            <div class="topicos">
                <div class="fin">AAAAAA</div>
                <div class="fin">BBBBBBBBB</div>
            </div>

        </div>

    </div>


    <div class="container">

        <div class="conteudo">

            <div class="proporcao">

                <div class="subtitulo">Precisa de uma quantidade maior de chá?
                    <br>Veja aqui a proporção
                </div>

                <div style="display: flex; justify-content: space-between; margin-bottom: 5vh;">
                    <div id="divProporcao"><input class="iptCoisas" type="number" min="1" max="30" id="iptProporcao"
                            placeholder="Insira aqui quantas xícaras deseja fazer"></div>
                    <button id="btnProporcao">Calcular</button>
                </div>

                <div class="texto">
                    Lorem ipsum dolor, sit amet consectetur adipisicing elit. Labore architecto quos, vel a laborum
                    veniam sit reprehenderit quisquam dolorem eligendi delectus. Laudantium ea distinctio veniam
                    commodi. Ducimus aliquid praesentium provident?
                </div>

            </div>

            <!-- <div class="">Lorem, ipsum dolor sit amet consectetur adipisicing elit. Quos impedit unde aperiam quas reprehenderit? Assumenda soluta atque culpa obcaecati exercitationem iure accusamus, voluptatum magni unde perferendis iste inventore tempore est?</div> -->

        </div>

    </div>

    <footer>



    </footer>

</body>

</html>

<script>

    function pesquisarCha() {
        var nomeCha = iptPesquisaCha.value;

        if (nomeCha == '') {
            alert("Campo vazio!")
        } else {
            fetch("/cha/listarCha", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    nomeChaServer: nomeCha
                })
            }).then(function (resposta) {

                console.log("resposta: ", resposta);

                if (resposta.ok) {

                    resposta.json().then(json => {

                        //alguma coisa aqui.... não vai dar pra reusar a função
                        if (json.length > 0) {
                            alert("achei coisa aqui ó")
                            divNomeCha.innerHTML = `${json[0].nome}`
                            divDescCha.innerHTML = `<span>${json[0].descricao}</span><img style="border-radius:5vh;" id="imgCha" src="${json[0].imagem}"
                    alt="">`
                        } else {
                            divMSgErroPesquisa.innerHTML = "O chá não foi encontrado em nossa base de dados"
                        }
                    });

                } else {
                    throw ("Houve um erro ao tentar pesquisar o chá!");
                }
            }).catch(function (resposta) {
                console.log(`#ERRO: ${resposta}`);
            });

            return false;
        }
    }

</script>